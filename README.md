# **KorCham**
컴퓨터활용능력 자격증 자리확인 매크로

<p align="center">
	<img src="https://user-images.githubusercontent.com/50317129/78545141-3de1d980-7836-11ea-81f4-08cdeb1f2c92.png" alt="Main" title="Main">
</p>

2월 끝자락에 공부를 마무리하고 시험을 보려고 했으나, COVID-19의 여파로 시험이 14일까지 중지되는 바람에 가뜩이나 없는 자리가 몰려서 자리를 구할 수가 없게됐다.
<br />
회사에서 하루 종일 자격증 자리만 쳐다볼 수도 없는 노릇이고, 일일히 들어가기도 귀찮은데다, 까먹는 일도 더러 있어서 자리 잡기가 난감했다.
<br />
이미 다 끝낸 공부임에도 지속적으로 기억하기 위해 계속 붙잡고 있는게 너무 싫어서 최대한 빨리 자리를 잡을 필요가 있었다.
<br />
이 프로그램은 그러한 취지에서 개발됐다.

## KorCham 2.4 RELEASE (Latest)

+ 간단한 프로그램 구동을 위한 cmd, sh, bash 파일 추가

+ 시간이 1000ms를 넘어갈 시 단위가 s로 변경되도록 개선

## KorCham 2.3 RELEASE

+ 설정 파일에 지정된 사운드 경로에 사운드 파일이 없을 경우 사용자의 선택에 따라 사운드 파일을 다운로드 받을 수 있도록 개선

## KorCham 2.2 RELEASE

+ URL연결 시간 및 데이터 처리 시간 출력기능 추가

+ KorChamConf.json 파일이 없을 경우 자동으로 기본 설정값을 가진 json파일이 생성되도록 개선

## KorCham 2.1 RELEASE

+ 좌석 발생 시 사운드 출력 기능 추가

+ 설정 파일에서 관련 설정이 가능하도록 개선

## KorCham 2.0 RELEASE

+ KorChamConf.json을 통한 URL, 날짜 지정기능 추가

## KorCham 1.0 RELEASE

+ 컴퓨터 활용능력 1급 서울 상공회의소 제 3 ~ 5시험장의 3월 18일까지의 좌석 수 출력

# **INFO**

개발언어 : `JAVA`

#### **지원 OS**
+ Microsoft **Windows10**
+ AIX
+ CentOS
+ 기타 JVM 구동 가능한 디바이스

#### **JAVA VERSION**
+ **JDK 1.8**

---
### **사용 방법**
컴파일 결과물은 **.jar**파일이며, 해당 파일을 실행하면 자동으로 설정파일의 내용대로 지정된 날짜까지의 좌석을 탐지하고 출력한다.
<br />
좌석이 없을 경우 별도의 내용이 출력되지 않으며, 좌석이 하나 이상 있을 경우 URL의 순번과 날짜, 시간, 좌석 수를 출력한다.
<br />

프로그램 시작 방법은 기본적인 JAVA 명령어를 사용하거나, Shell 파일을 실행해서 구동할 수 있다.
<br />
<br />

**JAVA 명령어 실행** : cmd 혹은 PowerShell을 키고 KorCham.jar가 위치한 폴더로 이동해서 `java -jar KorCham.jar` 명령어를 실행한다.
<br />

**start.cmd** : Windows OS용 Shell 프로그램으로, 해당 Shell을 실행하면 자동으로 프로그램이 실행된다.
<br />

**start.sh** : sh계열 Terminal용 Shell 프로그램으로, 해당 Shell을 실행하면 자동으로 프로그램이 실행된다. CLI 환경에서의 실행방법은 `./start.sh` 명령어를 입력하면 된다.
<br />

**start.bash** : bash계열 Terminal용 Shell 프로그램으로, 해당 Shell을 실행하면 자동으로 프로그램이 실행된다. CLI 환경에서의 실행방법은 `./start.bash` 명령어를 입력하면 된다.
<br />

**KorChamConf.json** 설정파일을 통해 프로그램의 세부 사항을 지정할 수 있다. 좌석을 검사할 대상의 URL은 JSON Array을 통해 여러개의 URL을 지정할 수 있으며, URL별로 날짜 또한 개별적으로 지정할 수 있다.
<br />
그 밖에도 로그의 경로나 사운드파일의 경로, 기능 사용 여부를 지정할 수 있다.
<br />

자세한 설정파일 사용 방법은 아래의 **설정방법** 문단을 확인한다.

---
### **설정방법**

KorCham이 실행되면 KorCham.jar 위치에 설정파일이 존재하는지 여부를 확인하고, 없을 경우 KorChamConf.json을 생성한다.
<br />

<p align="center">
	<img src="https://user-images.githubusercontent.com/50317129/78545134-3c181600-7836-11ea-8261-88e19f69e923.png" alt="Main" title="Main">
</p>

KorChamConf.json의 형태는 위 사진과 같으며, 설정방법은 아래와 같다.
<br />
<br />

**logPath** : 로그파일 저장 경로 (기본값: %KorCham.jar위치%\\logs\\yyyy-MM-dd hh-mm-ss.log)
<br />

**soundFile** : .wav파일 경로 (기본값: %KorCham.jar위치%\\sound\\alert.wav)
<br />

**logActive** : 로그기능 사용 여부 (기본값 : true)
<br />
true : 로그 기능 사용
<br />
false: 로그 기능 미사용
<br />

**soundActive** : 사운드 기능 사용 여부 (기본값 : true)
<br />
true : 사운드 기능 사용
<br />
false : 사운드 기능 미사용
<br />

**urlList** : 좌석을 감시할 URL 배열
<br />
**url** : URL (기본값 : 컴퓨터 활용능력 1급 서울 상공회의소(남대문) 제 3 ~ 5시험장)
<br />
**시험장 확인 URL은 사용자에게 숨겨져 있어서 Fiddler와 같은 프로그램을 이용해 Request를 받아서 따와야 한다.**
<br />

**date** : 좌석을 검사할 가장 마지막 날짜 (기본값 : 최초로 KorChamConf.json 생성일자의 15일 이후)
<br />
[yyyy. mm. dd]의 형태로 입력하면, 해당 날짜 전 까지만 검사한다.
<br />

urlList의 경우, 배열형태로 이루어져 있어 여러 URL을 등록해서 감시할 수 있다.
<br />
물론 URL의 개수가 많아질 수록 프로그램의 루틴이 점점 길어진다.
<br />
<br />

**\\를 이용한 경로는 반드시 \\\\처럼 두번 입력해야 인식이 가능하니 주의**

---
### **주의사항**

실행 시 JDK가 1.8 이상인지 확인할 것.
<br />
Windows OS의 경우 경로가 (\\, 역슬래쉬)로 표시되는데, json 파일에서 이러한 역슬래쉬를 표시하려면 \\를 두번 입력해야 정상적으로 json에서 표시할 수 있다.
<br />
즉, 실제 경로가 `C:\Program Files`라면, json 파일에는 `C:\\Program Files`라고 입력해야 정상적으로 인식이 가능하다.
<br />
이는 프로그래밍에서 \\가 다른 알파벳과 결합하여 ASCII와 같은 특수문자를 매칭해 표현하는데 사용되기 때문으로, 프로그래밍 상의 한계라 어쩔 수 없다.

---
### **여담**

해당 프로그램을 사용하여 꽤나 타이트한 자리싸움에서 가장 빠른 3월 15일에 신청을 성공했다.
<br />
...는 COVID-19의 무지막지한 기승으로 밀리게 되고, 다시 가장 빠른 23일에 신청했다.
<br />
....는 또 밀려서 다시금 가장 빠른 4월 5일에 신청에 성공했고, 무사히 시험을 볼 수 있었다.
<br />

무려 두 번이나 밀렸음에도 악착같이 가장 빠른 시간대에 잡았던 것으로 보아 확실히 무작정 들어가서 자리를 확인하는 것 보다 효율적이였다. 사용하기 전 보다 확실히 차이가 남을 쓰면서 체감했다.
<br />
<br />

어찌보면 자리 싸움에서 우위를 차지하므로 부정행위라는 생각도 해봤는데, 공연 티켓팅 프로그램마냥 자동적으로 자리를 잡아주는 것도 아니고, 단순히 자리의 갯수만을 알려주는데서 그친다.
<br />
즉, 프로그램이 암만 알려줘도 실제로 자리를 차지하는 건 손싸움. 실제로도 괜찮은 자리를 놓쳤던 경험이 몇 번 있었다.
<br />
또한 나처럼 업무 자체가 컴퓨터로 뭘 하는 게 아니라면 결국 의미가 없어져버리는 셈. 애플리케이션 개발에 대한 지식이 조금 있으면 간단한 통신을 통한 PUSH알림 형태의 앱을 만들어볼까 생각도 했는데, 어차피 나만 쓸 거 같고, 간단한 애플리케이션이라도 직접 만드는 건 또 다른 느낌이라서 보류.
<br />
만약 이 프로그램이 정말 인기가 많아진다면 한 번 시도해보는 것도 나쁘지 않을 것 같다.
<br />

통상 3개의 서울 URL을 돌리는데 한 4초 정도 걸리는데, 설정파일 추가 이후 갑자기 한 사이클 당 8초로 늘어난 적이 있었다.
<br />
설정파일의 문제인가 싶어 구 버전의 프로그램을 돌려봐도 마찬가지. 다른 PC에서도 같은 현상이 일어났다.
<br />
이를 확인하기 위해 접속 시간과 데이터 처리 시간을 나누어 표시해봤으나, 접속 시간이 99% 이상을 차지했다. 설정파일이 추가되면서 이에 따른 데이터 처리 비용의 증가 가능성을 염두에 두었지만, JAVA는 내 생각보다 훨씬 빨랐다.
<br />
로그를 확인해보니, 새벽 시간에 URL접속이 정상적으로 이루어지지 않았고, 다시 접속이 재개된 이후 8초로 늘어남을 확인. 프로그램이 아닌 서버의 문제로 보여진다.
<br />
실제로 해당 URL의 HTML 페이지를 따서 테스트로 톰캣에 올려봤는데, 한 사이클 당 7ms만에 처리가 이루어지는 것을 확인했다. 물론 이 페이지는 DB를 읽는 등의 내부 로직이 없는 단순 HTML 코드이므로 매우 빠를 수 밖에.
<br />
결론적으로 해당 프로그램에서 한 사이클의 처리 속도는 전적으로 서버의 접속 속도에 따라 달라진다.
<br />
프로그램엔 총 처리 시간만 표출됐지만, 이 문제로 인해 접속시간과 처리시간을 나누어 표시하게 됐다.
<br />

프로그램의 구조 상 다른 자격증이나, 공연이나 기타 상품의 재고량 등이 HTML 테이블 및 &lt;tr&gt;, &lt;td&gt; 형태로 제공되는 경우, 해당 테이블의 id나 class값을 확인해서 소스코드만 바꿔주면 다른 식으로도 응용이 가능하다. 물론 HTML의 구조나 표현 방식에 따른 디테일은 알아서 신경써줘야 할 여지가 있다.
<br />
특히 상공회의소에 최적화되어있기 때문에 워드프로세서 등 다른 상공회의소 자격시험 응시 시, URL만 제대로 입력해주면 원만하게 사용이 가능하다.
<br />

개발 당시 3월 15일 시험이 아직 밀리지 않았었고, 이미 프로토타입 구동 시에 원하는 자리를 잡은 덕택에 사용 시간보다 개발 시간이 더 많았을 뻔 했으나, COVID-19의 영향으로 지속적으로 밀리면서 진가를 발휘한 프로그램
<br />

어차피 며칠만 쓸 프로그램이라 생각하고 개발한거라 설정 파일의 내용들은 원래 하드코딩되어 있었으나, 지속적인 일정 연기와 회사의 단축근무로 인해 여유가 많아져 프로그램의 많은 부분들을 개선할 수 있었다.
<br />
어찌보면 COVID-19는 이 프로그램이 발전할 수 있었던 원동력(?)이 된 셈이다.
